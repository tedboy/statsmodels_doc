

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.11.6.1.4. statsmodels.stats.correlation_tools.corr_nearest_factor &mdash; Statsmodels API v1</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Statsmodels API v1" href="../index.html"/>
        <link rel="up" title="3.11.6. statsmodels.stats.correlation_tools" href="statsmodels.stats.correlation_tools.html"/>
        <link rel="next" title="3.11.6.1.5. statsmodels.stats.correlation_tools.corr_thresholded" href="statsmodels.stats.correlation_tools.corr_thresholded.html"/>
        <link rel="prev" title="3.11.6.1.3. statsmodels.stats.correlation_tools.corr_nearest" href="statsmodels.stats.correlation_tools.corr_nearest.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Statsmodels API
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../main_api.html">1. Main API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc_basic/index.html">2. Basic Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../main.html">3. Main modules of interest</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodel">3.1. statsmodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodel-discrete">3.2. statsmodel.discrete</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodel-distributions">3.3. statsmodel.distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodel-emplike">3.4. statsmodel.emplike</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodel-genmod">3.5. statsmodel.genmod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodel-graphics">3.6. statsmodel.graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodel-miscmodels">3.7. statsmodel.miscmodels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodels-nonparametric">3.8. statsmodels.nonparametric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodels-regression">3.9. statsmodels.regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../main.html#statsmodel-robust">3.10. statsmodel.robust</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../main.html#statsmodel-stats">3.11. statsmodel.stats</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.api.html">3.11.1. statsmodels.stats.api</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.adnorm.html">3.11.2. statsmodels.stats.adnorm</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.anova.html">3.11.3. statsmodels.stats.anova</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.base.html">3.11.4. statsmodels.stats.base</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.contrast.html">3.11.5. statsmodels.stats.contrast</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="statsmodels.stats.correlation_tools.html">3.11.6. statsmodels.stats.correlation_tools</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="statsmodels.stats.correlation_tools.html#functions">3.11.6.1. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="statsmodels.stats.correlation_tools.html#classes">3.11.6.2. Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="statsmodels.stats.correlation_tools.html#exceptions">3.11.6.3. Exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.descriptivestats.html">3.11.7. statsmodels.stats.descriptivestats</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.diagnostic.html">3.11.8. statsmodels.stats.diagnostic</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.gof.html">3.11.9. statsmodels.stats.gof</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.inter_rater.html">3.11.10. statsmodels.stats.inter_rater</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.lilliefors.html">3.11.11. statsmodels.stats.lilliefors</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.moment_helpers.html">3.11.12. statsmodels.stats.moment_helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.multicomp.html">3.11.13. statsmodels.stats.multicomp</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.multitest.html">3.11.14. statsmodels.stats.multitest</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.multivariate_tools.html">3.11.15. statsmodels.stats.multivariate_tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.outliers_influence.html">3.11.16. statsmodels.stats.outliers_influence</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.power.html">3.11.17. statsmodels.stats.power</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.proportion.html">3.11.18. statsmodels.stats.proportion</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.sandwich_covariance.html">3.11.19. statsmodels.stats.sandwich_covariance</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.stattools.html">3.11.20. statsmodels.stats.stattools</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.tabledist.html">3.11.21. statsmodels.stats.tabledist</a></li>
<li class="toctree-l3"><a class="reference internal" href="statsmodels.stats.weightstats.html">3.11.22. statsmodels.stats.weightstats</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../submain.html">4. Other modules of interest</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sandbox.html">5. statsmodel.sandbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sandbox2.html">6. statsmodel.sandbox2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/index.html">7. From official doc</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Statsmodels API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../main.html">3. Main modules of interest</a> &raquo;</li>
        
          <li><a href="statsmodels.stats.correlation_tools.html">3.11.6. statsmodels.stats.correlation_tools</a> &raquo;</li>
        
      <li>3.11.6.1.4. statsmodels.stats.correlation_tools.corr_nearest_factor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/generated/statsmodels.stats.correlation_tools.corr_nearest_factor.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="statsmodels-stats-correlation-tools-corr-nearest-factor">
<h1>3.11.6.1.4. statsmodels.stats.correlation_tools.corr_nearest_factor<a class="headerlink" href="#statsmodels-stats-correlation-tools-corr-nearest-factor" title="Permalink to this headline">Â¶</a></h1>
<dl class="function">
<dt id="statsmodels.stats.correlation_tools.corr_nearest_factor">
<code class="descclassname">statsmodels.stats.correlation_tools.</code><code class="descname">corr_nearest_factor</code><span class="sig-paren">(</span><em>corr</em>, <em>rank</em>, <em>ctol=1e-06</em>, <em>lam_min=1e-30</em>, <em>lam_max=1e+30</em>, <em>maxiter=1000</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/statsmodels/stats/correlation_tools.html#corr_nearest_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#statsmodels.stats.correlation_tools.corr_nearest_factor" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find the nearest correlation matrix with factor structure to a
given square matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>corr</strong> : square array</p>
<blockquote>
<div><p>The target matrix (to which the nearest correlation matrix is
sought).  Must be square, but need not be positive
semidefinite.</p>
</div></blockquote>
<p><strong>rank</strong> : positive integer</p>
<blockquote>
<div><p>The rank of the factor structure of the solution, i.e., the
number of linearly independent columns of X.</p>
</div></blockquote>
<p><strong>ctol</strong> : positive real</p>
<blockquote>
<div><p>Convergence criterion.</p>
</div></blockquote>
<p><strong>lam_min</strong> : float</p>
<blockquote>
<div><p>Tuning parameter for spectral projected gradient optimization
(smallest allowed step in the search direction).</p>
</div></blockquote>
<p><strong>lam_max</strong> : float</p>
<blockquote>
<div><p>Tuning parameter for spectral projected gradient optimization
(largest allowed step in the search direction).</p>
</div></blockquote>
<p><strong>maxiter</strong> : integer</p>
<blockquote>
<div><p>Maximum number of iterations in spectral projected gradient
optimization.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rslt</strong> : Bunch</p>
<blockquote class="last">
<div><p>rslt.corr is a FactoredPSDMatrix defining the estimated
correlation structure.  Other fields of <cite>rslt</cite> contain
returned values from spg_optim.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>A correlation matrix has factor structure if it can be written in
the form I + XX&#8217; - diag(XX&#8217;), where X is n x k with linearly
independent columns, and with each row having sum of squares at
most equal to 1.  The approximation is made in terms of the
Frobenius norm.</p>
<p>This routine is useful when one has an approximate correlation
matrix that is not positive semidefinite, and there is need to
estimate the inverse, square root, or inverse square root of the
population correlation matrix.  The factor structure allows these
tasks to be done without constructing any n x n matrices.</p>
<p>This is a non-convex problem with no known gauranteed globally
convergent algorithm for computing the solution.  Borsdof, Higham
and Raydan (2010) compared several methods for this problem and
found the spectral projected gradient (SPG) method (used here) to
perform best.</p>
<p>The input matrix <cite>corr</cite> can be a dense numpy array or any scipy
sparse matrix.  The latter is useful if the input matrix is
obtained by thresholding a very large sample correlation matrix.
If <cite>corr</cite> is sparse, the calculations are optimized to save
memory, so no working matrix with more than 10^6 elements is
constructed.</p>
<p class="rubric">References</p>
<p>R Borsdof, N Higham, M Raydan (2010).  Computing a nearest
correlation matrix with factor structure. SIAM J Matrix Anal
Appl, 31:5, 2603-2622.
<a class="reference external" href="http://eprints.ma.man.ac.uk/1523/01/covered/MIMS_ep2009_87.pdf">http://eprints.ma.man.ac.uk/1523/01/covered/MIMS_ep2009_87.pdf</a></p>
<p class="rubric">Examples</p>
<p>Hard thresholding a correlation matrix may result in a matrix that
is not positive semidefinite.  We can approximate a hard
thresholded correlation matrix with a PSD matrix as follows, where
<cite>corr</cite> is the input correlation matrix.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">corr</span> <span class="o">=</span> <span class="n">corr</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rslt</span> <span class="o">=</span> <span class="n">corr_nearest_factor</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="statsmodels.stats.correlation_tools.corr_thresholded.html" class="btn btn-neutral float-right" title="3.11.6.1.5. statsmodels.stats.correlation_tools.corr_thresholded" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="statsmodels.stats.correlation_tools.corr_nearest.html" class="btn btn-neutral" title="3.11.6.1.3. statsmodels.stats.correlation_tools.corr_nearest" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>